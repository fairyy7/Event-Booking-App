{"version":3,"names":["promptForDeviceSelection","availableDevices","device","prompts","type","name","message","choices","filter","d","map","title","chalk","bold","value","min","listIOSDevices","devices","out","execa","sync","parseXctraceIOSDevicesList","stderr","stdout","e","logger","warn","parseIOSDevicesList"],"sources":["../../../src/commands/runIOS/listIOSDevices.ts"],"sourcesContent":["import {Device} from '../../types';\nimport parseIOSDevicesList from '../../tools/parseIOSDevicesList';\nimport parseXctraceIOSDevicesList from '../../tools/parseXctraceIOSDevicesList';\nimport execa from 'execa';\nimport {logger} from '@react-native-community/cli-tools';\nimport prompts from 'prompts';\nimport chalk from 'chalk';\n\nexport async function promptForDeviceSelection(\n  availableDevices: Device[],\n): Promise<Device | undefined> {\n  const {device} = await prompts({\n    type: 'select',\n    name: 'device',\n    message: 'Select the device you want to use',\n    choices: availableDevices\n      .filter((d) => d.type === 'device' || d.type === 'simulator')\n      .map((d) => ({\n        title: `${chalk.bold(d.name)}`,\n        value: d,\n      })),\n    min: 1,\n  });\n  return device;\n}\n\nasync function listIOSDevices(): Promise<Device[]> {\n  let devices;\n  try {\n    const out = execa.sync('xcrun', ['xctrace', 'list', 'devices']);\n    devices = parseXctraceIOSDevicesList(\n      // Xcode 12.5 introduced a change to output the list to stdout instead of stderr\n      out.stderr === '' ? out.stdout : out.stderr,\n    );\n  } catch (e) {\n    logger.warn(\n      'Support for Xcode 11 and older is deprecated. Please upgrade to Xcode 12.',\n    );\n    devices = parseIOSDevicesList(\n      execa.sync('xcrun', ['instruments', '-s']).stdout,\n    );\n  }\n  return devices;\n}\n\nexport default listIOSDevices;\n"],"mappings":";;;;;;;AACA;AACA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA0B;AAEnB,eAAeA,wBAAwB,CAC5CC,gBAA0B,EACG;EAC7B,MAAM;IAACC;EAAM,CAAC,GAAG,MAAM,IAAAC,kBAAO,EAAC;IAC7BC,IAAI,EAAE,QAAQ;IACdC,IAAI,EAAE,QAAQ;IACdC,OAAO,EAAE,mCAAmC;IAC5CC,OAAO,EAAEN,gBAAgB,CACtBO,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACL,IAAI,KAAK,QAAQ,IAAIK,CAAC,CAACL,IAAI,KAAK,WAAW,CAAC,CAC5DM,GAAG,CAAED,CAAC,KAAM;MACXE,KAAK,EAAG,GAAEC,gBAAK,CAACC,IAAI,CAACJ,CAAC,CAACJ,IAAI,CAAE,EAAC;MAC9BS,KAAK,EAAEL;IACT,CAAC,CAAC,CAAC;IACLM,GAAG,EAAE;EACP,CAAC,CAAC;EACF,OAAOb,MAAM;AACf;AAEA,eAAec,cAAc,GAAsB;EACjD,IAAIC,OAAO;EACX,IAAI;IACF,MAAMC,GAAG,GAAGC,gBAAK,CAACC,IAAI,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;IAC/DH,OAAO,GAAG,IAAAI,mCAA0B;IAClC;IACAH,GAAG,CAACI,MAAM,KAAK,EAAE,GAAGJ,GAAG,CAACK,MAAM,GAAGL,GAAG,CAACI,MAAM,CAC5C;EACH,CAAC,CAAC,OAAOE,CAAC,EAAE;IACVC,kBAAM,CAACC,IAAI,CACT,2EAA2E,CAC5E;IACDT,OAAO,GAAG,IAAAU,4BAAmB,EAC3BR,gBAAK,CAACC,IAAI,CAAC,OAAO,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,CAACG,MAAM,CAClD;EACH;EACA,OAAON,OAAO;AAChB;AAAC,eAEcD,cAAc;AAAA"}